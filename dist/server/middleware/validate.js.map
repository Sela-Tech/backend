{"version":3,"sources":["../../../middleware/validate.js"],"names":["dotenv","require","config","options","enforce","lowercase","uppercase","specialCharacters","numbers","validator","validateRequestResetPasswordEmail","request","response","checkBody","isEmail","validateResetPassword","matches","notEmpty","equals","body","confirmPassword","validateAddTask","req","res","validateAddMilestone","isArray","validateAddAreaOfInterest","validateAddComment","validateAddEvidenceRequest","capitalizeFirst","name","charAt","toUpperCase","slice","comparePassword","password1","hashedPassword","bcrypt","compareSync","hashPassword","password","salt","genSaltSync","hashSync","toTitleCase","str","replace","txt","substr","toLowerCase","module","exports"],"mappings":";;AAAA;AACA,IAAMA,SAASC,QAAQ,QAAR,CAAf;;AAEAD,OAAOE,MAAP;;AAEA,IAAMC,UAAU;AACdC,WAAS;AACPC,eAAW,IADJ;AAEPC,eAAW,IAFJ;AAGPC,uBAAmB,IAHZ;AAIPC,aAAS;AAJF;AADK,CAAhB;;AAUA,IAAMC,YAAY;;AAEhB;AACAC,mCAHgB,6CAGkBC,OAHlB,EAG2BC,QAH3B,EAGqC;AACnDD,YACGE,SADH,CACa,OADb,EACsB,6BADtB,EAEGC,OAFH;AAGD,GAPe;;;AAShB;AACAC,uBAVgB,iCAUMJ,OAVN,EAUeC,QAVf,EAUyB;AACzCD,YACGE,SADH,CACa,aADb,EAEI,uEAFJ,EAIGG,OAJH,CAIW,mCAJX;;AAMAL,YACGE,SADH,CACa,iBADb,EAEI,6CAFJ,EAIGI,QAJH;AAKAN,YACGE,SADH,CACa,aADb,EAC4B,uBAD5B,EAEGK,MAFH,CAEUP,QAAQQ,IAAR,CAAaC,eAFvB;AAGC,GAzBe;AA4BhBC,iBA5BgB,2BA4BAC,GA5BA,EA4BKC,GA5BL,EA4BS;AACvBD,QACCT,SADD,CACW,MADX,EAEE,2BAFF,EAICI,QAJD;AAKFK,QACGT,SADH,CACa,SADb,EACwB,yBADxB,EAEGI,QAFH;;AAIEK,QACCT,SADD,CACW,aADX,EAC0B,yBAD1B,EAECI,QAFD;;AAIAK,QACCT,SADD,CACW,eADX,EAC4B,gCAD5B,EAECI,QAFD;AAGD,GA7Ce;AA+ChBO,sBA/CgB,gCA+CKF,GA/CL,EA+CUC,GA/CV,EA+Cc;AAC5BD,QACCT,SADD,CACW,OADX,EAEE,iCAFF,EAICI,QAJD;;AAMAK,QACCT,SADD,CACW,WADX,EAEE,oBAFF,EAICI,QAJD;;AAMAK,QACCT,SADD,CACW,OADX,EACoB,+BADpB,EAECY,OAFD,GAGCR,QAHD;AAID,GAhEe;AAmEhBS,2BAnEgB,qCAmEUJ,GAnEV,EAmEeC,GAnEf,EAmEmB;AACjCD,QACCT,SADD,CACW,iBADX,EAC8B,kCAD9B,EAECY,OAFD,GAGCR,QAHD;AAID,GAxEe;AA0EhBU,oBA1EgB,8BA0EGL,GA1EH,EA0EQC,GA1ER,EA0EY;AAC1BD,QACCT,SADD,CACW,SADX,EAEE,0BAFF,EAICI,QAJD;AAKD,GAhFe;AAkFhBW,4BAlFgB,sCAkFWN,GAlFX,EAkFgBC,GAlFhB,EAkFoB;AAClCD,QACCT,SADD,CACW,OADX,EACmB,wBADnB,EAECI,QAFD;AAGAK,QACCT,SADD,CACW,SADX,EACqB,yBADrB,EAECI,QAFD;AAGAK,QACCT,SADD,CACW,OADX,EACmB,wCADnB,EAECI,QAFD;AAGAK,QACCT,SADD,CACW,OADX,EACmB,uCADnB,EAECI,QAFD;AAGAK,QACCT,SADD,CACW,cADX,EAC0B,qCAD1B,EAECY,OAFD,GAGCR,QAHD;AAIAK,QACCT,SADD,CACW,UADX,EACsB,qDADtB,EAECI,QAFD;AAGD,GAtGe;;;AAwGhB;AACAY,iBAzGgB,2BAyGAC,IAzGA,EAyGM;AACpB,WAAOA,KAAKC,MAAL,CAAY,CAAZ,EAAeC,WAAf,KAA+BF,KAAKG,KAAL,CAAW,CAAX,CAAtC;AACD,GA3Ge;;;AA8GhB;AACAC,iBA/GgB,2BA+GAC,SA/GA,EA+GWC,cA/GX,EA+G2B;AACzC,QAAIC,OAAOC,WAAP,CAAmBH,SAAnB,EAA8BC,cAA9B,CAAJ,EAAmD;AACjD,aAAO,IAAP;AACD;AACD,WAAO,KAAP;AACD,GApHe;;;AAuHhB;AACAG,cAxHgB,wBAwHHC,QAxHG,EAwHO;AACrB,QAAMC,OAAOJ,OAAOK,WAAP,CAAmB,CAAnB,CAAb;AACA,WAAOL,OAAOM,QAAP,CAAgBH,QAAhB,EAA0BC,IAA1B,CAAP;AACD,GA3He;;;AA6HhB;AACAG,aA9HgB,uBA8HJC,GA9HI,EA8HC;AACf,WAAOA,IAAIC,OAAJ,CAAY,QAAZ,EAAsB,UAAUC,GAAV,EAAe;AAC1C,aAAOA,IAAIhB,MAAJ,CAAW,CAAX,EAAcC,WAAd,KAA8Be,IAAIC,MAAJ,CAAW,CAAX,EAAcC,WAAd,EAArC;AACD,KAFM,CAAP;AAGD;AAlIe,CAAlB;;AA0IAC,OAAOC,OAAP,GAAgB1C,SAAhB","file":"validate.js","sourcesContent":["// const bcrypt = require('bcrypt-nodejs');\nconst dotenv = require('dotenv');\n\ndotenv.config();\n\nconst options = {\n  enforce: {\n    lowercase: true,\n    uppercase: true,\n    specialCharacters: true,\n    numbers: true\n  }\n};\n\n\nconst validator = {\n\n  //validates reset password request email\n  validateRequestResetPasswordEmail(request, response) {\n    request\n      .checkBody(\"email\", \"Please enter a valid email.\")\n      .isEmail();\n  },\n\n  // validates reset password\n  validateResetPassword(request, response) {\n  request\n    .checkBody(\"newPassword\",\n      \"Password can't be less than 8 characters and must not contain spaces.\"\n    )\n    .matches(/^[a-zA-Z0-9!@#$%^&*()_\\-.]{8,32}$/);\n\n  request\n    .checkBody(\"confirmPassword\",\n      \"Password confirmation field can't be empty.\"\n    )\n    .notEmpty();\n  request\n    .checkBody(\"newPassword\", \"Password didn't match\")\n    .equals(request.body.confirmPassword);\n  },\n\n\n  validateAddTask(req, res){\n    req\n    .checkBody(\"name\",\n      \"Task name can't be empty.\"\n    )\n    .notEmpty();\n  req\n    .checkBody(\"dueDate\", \"please specify due date\")\n    .notEmpty();\n\n    req\n    .checkBody(\"description\", \"Decription cannot empty\")\n    .notEmpty();\n\n    req\n    .checkBody(\"estimatedCost\", \"Please enter an estimated cost\")\n    .notEmpty();\n  },\n\n  validateAddMilestone(req, res){\n    req\n    .checkBody(\"title\",\n      \"Milestone title can't be empty.\"\n    )\n    .notEmpty()\n\n    req\n    .checkBody(\"projectId\",\n      \"Invalid projectId.\"\n    )\n    .notEmpty()\n   \n    req\n    .checkBody(\"tasks\", \"You must add atleast one task\")\n    .isArray()\n    .notEmpty();\n  },\n  \n\n  validateAddAreaOfInterest(req, res){\n    req\n    .checkBody(\"areasOfInterest\", \"Add atleast one area of interest\")\n    .isArray()\n    .notEmpty();\n  },\n\n  validateAddComment(req, res){\n    req\n    .checkBody(\"comment\",\n      \"comment cannot be empty.\"\n    )\n    .notEmpty()\n  },\n\n  validateAddEvidenceRequest(req, res){\n    req\n    .checkBody(\"title\",\"title cannot be empty.\")\n    .notEmpty()\n    req\n    .checkBody(\"project\",\"Please specify project.\")\n    .notEmpty()\n    req\n    .checkBody(\"level\",\"Please specify level(task or project).\")\n    .notEmpty()\n    req\n    .checkBody(\"quote\",\"Please specify quote for this request\")\n    .notEmpty()\n    req\n    .checkBody(\"stakeholders\",\"Please add who submits the evidence\")\n    .isArray()\n    .notEmpty()\n    req\n    .checkBody(\"datatype\",\"Please specify datatype(video, audio, image, e.t.c)\")\n    .notEmpty()\n  },\n\n  // capitalize First letter\n  capitalizeFirst(name) {\n    return name.charAt(0).toUpperCase() + name.slice(1)\n  },\n\n\n  // compared password\n  comparePassword(password1, hashedPassword) {\n    if (bcrypt.compareSync(password1, hashedPassword)) {\n      return true;\n    }\n    return false;\n  },\n\n\n  // hash password\n  hashPassword(password) {\n    const salt = bcrypt.genSaltSync(8);\n    return bcrypt.hashSync(password, salt);\n  },\n\n  // convert string to title case\n  toTitleCase(str) {\n    return str.replace(/\\w\\S*/g, function (txt) {\n      return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n    });\n  },\n  \n}\n\n\n\n\n\nmodule.exports =validator;"]}